# Резистентность к антибиотикам и терапия металлическими наночастицами

## Описание задачи

Резистентность к антибиотикам — серьезная проблема современной медицины. Заболевания, которые вызваны резистентными бактериями, с трудом поддаются лечению, а иногда и вовсе не лечатся. Для борьбы с такими бактериями биологи и медики постоянно ищут новые подходы, и один из вариантов — терапия металлическими наночастицами. Металлические наночастицы могут как воздействовать на бактерии самостоятельно (повреждая мембраны бактерий и генерируя радикальные частицы), так и усиливать эффект антибиотиков.

Задание состоит в построении предсказательной модели регрессии для прогнозирования ZOI - зоны игибирования роста бактерий - для комплексов лекарство-наночастицы.

## Инструменты:

`Python==3.9.16`
`Pandas==1.5.3`
`sklearn==1.2.2`
`seaborn==0.12.2`
`matplotlib==3.6.3`
`rdkit==2023.3.2`
`keras==2.12`
`numpy==1.23.5`
`Shap==0.42.0`
`CatBoost==1.2`
`ydata-profiling==4.1.2`

## Описание данных:

### место хранения:

- data.csv — основной набор данных (оценивает эффект наночастиц серебра (Ag) на бактерии)
- bacterial_descriptors.csv — дополнительная информация о бактериях
- drug_descriptors.csv — дополнительная информация о лекарстве

### описание признаков:

#### data.csv
Для всех образцов в датасете использовались наночастицы серебра Ag
- Bacteria - бактериальная клетка-мишень
- NP_Synthesis - тип синтеза наночастиц
- drug - название лекарства
- drug class - класс лекарства
- Drug dose - доза препарата
- NP_concentration - концентрация НЧ
- NP_size - размер НЧ
- shape - форма НЧ
- method - метод определения антимикробной активности
- ZOI_drug, ZOI_NP, ZOI_drug_NP - зона ингибирования препарата, НЧ и их комбинации
- Fold increase in antibacterial activity (%) - кратное увеличение антибактериальной активности (%)
- MDR - множественная лекарственная устойчивость резистентен ли обычный препарат к целевому патогену

#### bacterial_descriptors.csv
- Tax_id - id бактерии в базе данных NCBI
- Bacteria - название бактерии
- kingdom - царство бактерии
- subkingdom - подцарство бактерии
- clade - характеристика бактерии с точки зрения родственных взаимоотношений между таксономическими группами
- phylum - филум бактерии
- class - класс бактерии
- order - порядок бактерии
- family - семейство бактерии
- genus - род бактерии
- species - вид бактерии
- gram - результат реакции окрашивания по Грамму для бактерии
- min_Incub_period, avg_Incub_period, max_Incub_period h - характеристики инкубационного периода бактерии
- growth_temp, C - температура роста бактерии
- biosafety_level - уровень опасности бактерии
- isolated_from - источник

#### drug_descriptors.csv
- drug - название лекарства
- chemID - id лекарства в базе данных CHEMBL
- prefered_name - название лекарства
- smiles - химическая формула лекарства

## Краткое описание проведённой работы:
<i> 
Проанализированы данные: типы бактерий, методы синтеза наночастиц, лекарства, их дозы и классы, характеристики наночастиц, методы измерения активности, зоны ингибирования, усиление активности, зета-потенциал и лекарственную устойчивость. Построены модели на основе Catboost ,Keras для определения зона ингибирования препарата c наночастицами .Также все модели были интерпретированы при помощи shap </i>

## Ход работы:
- предобработка и анализ данных (h1af.ipynb)
- модель Keras + интерпретация (h1kf.ipynb)
- модель Catboost + интерпретация (h1cf.ipynb)

## Выводы по анализу
<i>Анализ данных позволил сделать следующие выводы:

Присутствуют нулевые значения эффективности препарата, которые не несут информативности. в дальнейшем удалим эти нулевые значения, чтобы они не вносили шум в модели.

Значения показателя ZOI_drug, превышающие 60, можно считать выбросами. Следует обратить внимание на эти значения, так как они могут исказить анализ и результаты моделирования.

Наблюдается разнообразие источников данных и методов расчетов, что может привести к неточностям и неоднородности в данных. Это может повлиять на стабильность и качество моделей.

Важно отметить, что в идеале требует дополнительной очистки и приведения к однородному формату. Однако, учитывая ограниченный объем данных, решено не проводить дополнительную очистку для сохранения ценной информации.</i>


## Общие Выводы
<i>В данной задаче решения было представлено два подхода. Один из них основывался на использовании градиентного бустинга с библиотекой CatBoost. Этот подход показал хорошие результаты с RMSE (среднеквадратичной ошибкой) в 4.5 и R2 (коэффициент детерминации) в 0.8. Графики Boxplot показали, что количество значительных ошибок было невелико, всего одно наблюдение с ошибкой больше 10.

Другой подход включал использование многослойной нейронной сети прямого распространения. Нейронная сеть имела архитектуру, которая дала R2 в 0.81 и RMSE в 5.71. Однако этот подход показал большую нестабильность в сравнении с градиентным бустингом, с несколькими наблюдениями, где ошибка превышала 10. Графики важности фичей и таблицы также подчеркнули, что нейронная сеть сильно полагалась на несколько ключевых фичей, что могло уменьшить её стабильность.

Выводы из проведенного анализа заключаются в том, что для данной задачи градиентный бустинг показал наилучшие результаты метрик, независимо от выбранного фреймворка. Однако, предположительно, с большим объемом данных нейронные сети могли бы дать более лучшие результаты.</i>
